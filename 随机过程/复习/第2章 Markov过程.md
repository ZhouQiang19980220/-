# 第2章 Markov过程

## Markov链的定义

1. 定义

   1. 状态离散，参数离散。

   2. 无后效性（马尔科夫性）：下一时刻状态仅与当前时刻状态有关，而与过去无关。
      $$
      \begin{gathered}
      P\left\{X(n+1)=i_{n+1} \mid X(0)=i_{0}, X(1)=i_{1}, \cdots, X(n)=i_{n}\right\}
      \\
      =
      P\left\{X(n+1)=i_{n+1} \mid X(n)=i_{n}\right\}
      \end{gathered}
      $$

2. 一步转移概率:$P\{X(n+1)=j \mid X(n)=i\} \hat{=} p_{i j}(n)$

3. 齐次马氏链：一步转移概率仅与状态有关，与时间无关。

4. 只要得到了马氏链的一步转移概率和初始分布，就可以得到齐次马氏链的任意前n维分布。

5. 一步转移概率满足
   $$
   \begin{aligned}
   &p_{i j}(n) \geq 0 \quad(i, j \in S) \\
   &\sum_{j \in S} p_{i j}(n)=1 \quad i \in S
   \end{aligned}
   $$

## C-K方程

1. m步转移概率:$p_{i j}^{(m)}(n)=P\{X(n+m)=j \mid X(n)=i\}$
2. c-k方程
   1. $p_{i j}^{(m+r)}=\sum_{k \in S} p_{i k}^{(m)} p_{k j}^{(r)} \quad(i, j \in S)$
   2. 用$(m+r)$步从$i$转移到$j$：先用$(m)$步从$i$转移到$k$，再用$(r)$步从$k$转移到$j$。
3. 矩阵形式：$P^{(m+n)}=P^{(m)}P^{(n)}$
4. 举例：$p_{ij}^{(2)}$是$P$的第$i$行乘以第$j$列。

## 常见的马氏链

1. 随机游动
2. 带吸收壁的随即游动
3. 带2个吸收壁的随即游动
4. 带1个反射壁的随机游动
5. 带2个反射壁的随机游动

## 马尔科夫链状态分类

1. 到达与想通：到达和相同具有传递性

2. 首达时间和首达概率

   1. 首达时间是随机变量。

   2. 首达时间：$f_{ij}$表示能到达概率，$f_{ij}^{\infty}$表示不能到达概率。
      $$
      f_{ij}+f_{ij}^{\infty}=1
      $$

3. 首达概率的基本性质

   1. 对于任意的 $i, j \in S, 0 \leq f_{i j}^{(n)} \leq p_{i j}^{(n)} \leq f_{i j} \leq 1$;
   2. 对于任意的 $i, j \in S$ 及 $1 \leq n<\infty$, 有: $p_{i j}^{(n)}=\sum_{l=1}^{n} f_{i j}^{(l)} p_{j j}^{(n-l)}$;
   3. 对于任意的 $i, j \in S, f_{i j}>0 \Leftrightarrow i \rightarrow j$;
   4. 对于任意的$ i, j \in S, f_{i j}>0 \text { and } f_{j i}>0 \Leftrightarrow i \leftrightarrow j$

4. 状态分类

   1. 正常返态：$f_{ii}=1,\mu_i<\infty$
   2. 零常返态：$f_{ii}=1,\mu_i<\infty$
   3. 非常返态（滑过态、瞬时态）:$f_{ii}<1$

5. 常返态和非常返态的判别

   1. 引理
      $$
      \begin{aligned}
      &P_{i j}(s)=\sum_{n=0}^{\infty} p_{i j}^{(n)} s^{n}=\delta_{i j}+\sum_{n=1}^{\infty} p_{i j}^{(n)} s^{n}
      \\
      &F_{i j}(s)=\sum_{n=1}^{\infty} f_{i j}^{(n)} s^{n}
      \\
      & P_{ij}(s)=\delta_{ij}+F_{ij}(s)P_{jj}(s)
      \\
      &
      P_{ii}(s)=\frac{1}{1-F_{ii}(s)}
      \end{aligned}
      $$

   2. 状态 $i \in S$ 是常返的 $\left(f_{i i}=1\right) \Leftrightarrow \sum_{n=0}^{\infty} p_{i i}^{(n)}=\infty$ 。

   3. 状态 $i \in S$ 是非常返的 $\left(f_{i i}<1\right) \Leftrightarrow \sum_{n=0}^{\infty} p_{i i}^{(n)}=\frac{1}{1-f_{i i}}<\infty$ 。

   4. 如果 $j \in S$ 是非常返的, 则对 $\forall i \in S$, 有 $\sum_{n=0}^{\infty} p_{i j}^{(n)}<\infty$; $\lim _{n \rightarrow \infty} p_{i j}^{(n)}=0$ 。

   5. 设 $i \leftrightarrow j$, 则 $i$ 和 $j$ 或者都是正常返的, 或者都是非常返的, 或者都是零常返的。

   6. 如果$i$是常返态，则$i$能到达的状态都是常返态，且都与$i$想通。

   7. 非常返态的访问次数是有限的，常返态的访问次数无限多。

   8. 有限状态马氏链不可能所有状态都是非常返态。

   9. 有限状态马氏链没有零常返态，至少一个正常返态。

6. 闭集和状态空间的分解。
   1. 闭集：C中的任意一个状态不能到达C外的状态。
   2. 吸收态：单个状态$i$构成闭集，$p_{ii}=1$。
   3. 不可约闭集：C中所有状态想通，且具有相同的性质（常返性和周期性）
   4. 闭集存在：正态状态空间S构成闭集。
   5. 不可约马氏链：状态空间S不可约时，所有状态都想通。
   6. 所有常返态构成一个闭集。

7. 常返、非常返、周期状态的分类特性。
   1. 周期性
      1. $p_{ii}>0$，则$i$是非周期状态。(有耳朵)
      2. $p_{ii}^{(n)}>0$且$p_{ii}^{(n+1)}>0$时，$i$为非周期。（连续两步都能回来）
      3. 如果存在正整数$m$，使得$m$步转移概率矩阵$P^{(m)}$的第$j$列元素都不为0，则j是非周期的。($p_{jj}^{(m)}>0,p_{jj}^{(m+1)}>0$)
   2. 遍历态：非周期、正常返。

8. 分解定理
   1. 齐次马氏链的状态空间唯一分解成一个非常返态集$D$和若干个不可约的互不相交的不可约闭集$C_i$，$C_i$中均是常返态。
   2. 周期链分解定理

9. 有限状态马氏链的性质
   1. 所有非常返态组成的集合不可能是闭集。
   2. 没有0常返态，必有正常返态。
   3. 不可约马氏链只有正常返态。

10. 常返态判据总结

    1. $f_{ii}=1$或者$f_{ii}^{\infty}=0$。
    2. $\sum_{n=0}^{\infty} p_{i i}^{(n)}=\infty$
    3. 如果$i$是常返态，则$i$能到达的状态都是常返态，并且与$i$想通。
    4. 有限状态马氏链必有正常返态，没有零常返态。
    5. 所有常返态构成闭集。


## 马氏链的极限性态和平稳分布

1. 要解决的问题。
   1. 当时间趋于无穷时的一维分布。
   2. 什么情况下，马氏链是平稳序列。
   
2. $P^{(n)}$的极限性态。（研究时间趋于无穷的一维分布本质是研究$P^{(n)}$的极限性质。)

   1. 当$j$是零常返或者非常返态时，对于任意的$i \in S$，$\lim_{n \rightarrow \infty} p_{ij}^{(n)}=0$

   2. $j$是零常返态，当且仅当$\lim_{n \rightarrow \infty} p_{jj}^{(n)}=0$

   3. 若$i$是周期为$d$的常返状态，则$\lim_{n \rightarrow \infty} p_{ii}^{(n)}=\frac{d}{\mu_i}$;若$i$是遍历态，则$\lim_{n \rightarrow \infty} p_{ii}^{(n)}=\frac{1}{\mu_i}$。

   4. Markov定理：如果一个有限状态马氏链是不可约遍历链，即所有状态都想通，都是非周期正常返状态，则
      $$
      \lim_{n \rightarrow \infty} P^{(n)}=\pi
      $$
      其中$\pi$是各行都相等的随机矩阵。

   5. 推论1：$\lim_{n \rightarrow \infty} P^{(n)}$是唯一的，且满足
      $$
      \pi P = \pi
      \\
      \sum_{i \in S} \pi_{i}=1
      $$

   6. 推论2：$\lim_{n \rightarrow \infty}P\{X_n=j\}=\pi_{j}$与初始分布无关。

   7. 定理：若$j$是遍历状态，则对于任意的$i\in S$,有
      $$
      \lim_{n \rightarrow \infty}p_{ij}^{(n)}=\frac{f_{ij}}{\mu_{ij}}
      $$
      

3. 平稳分布。

4. 一维分布的存在性。

## 非常返态分析

1. 从状态i出发进入状态子集$C_k$的概率。
2. 非常返态进入常返态的平均时间。